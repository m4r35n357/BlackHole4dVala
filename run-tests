#!/bin/sh

bh3ds=${1:-'./bh3dRk4 ./bh3dSymp'}
nbodys=${2:-'./nbody3d'}

C='\033[0;36m'
NC='\033[0m' # No Color

ic='initial-conditions.json'
pot='/tmp/potential'

int='./finterp.py'

params='{ "method": "dnewton", "rMin": 3.0, "rMax": 12.0, "thMin": 0.15, "spin": 1.0, "Lfac": 1.0 }'
echo $params | jq .
echo $params | ./icgenParticle >$ic 2>$pot
jq . $ic
for app in $bh3ds
do
	echo ${C}$app${NC}
	$app <$ic | $int tau 0.5 | ./plotBH.py `jq .M $ic` `jq .a $ic`
done

params='{ "method": "dnewton", "r": 12.0, "thMin": 0.0, "spin": 1.0, "Lfac": 1.0 }'
echo $params | jq .
echo $params | ./icgenParticle >$ic 2>$pot
jq . $ic
for app in $bh3ds
do
	echo ${C}$app${NC}
	$app <$ic | $int tau 0.5 | ./plotBH.py `jq .M $ic` `jq .a $ic`
done

params='{ "r": 3, "spin": 1.0 }'
echo $params | jq .
echo $params | ./icgenLight >$ic 2>$pot
jq . $ic
for app in $bh3ds
do
	echo ${C}$app${NC}
	$app <$ic | $int tau 0.5 | ./plotBH.py `jq .M $ic` `jq .a $ic`
done

jq . ic/Light1
for app in $bh3ds
do
	echo ${C}$app${NC}
	$app <ic/Light1 | $int t 0.5 | ./plotBH.py `jq .M ic/Light1` `jq .a ic/Light1`
done

for app in $nbodys
do
	echo ${C}$app${NC}
	$app <ic/SolarSystem 2>/tmp/progress | ./plotNBody.py
done

params='{ "method": "dnewton", "r": 12.0, "thMin": 0.5, "spin": 1.0, "Lfac": 1.0 }'
echo $params | jq .
echo $params | ./icgenParticle >$ic 2>$pot
jq . $ic
echo ${C}"./newton"${NC}
./newton <$ic | ./plotBH.py `jq .M $ic` `jq .a $ic`

